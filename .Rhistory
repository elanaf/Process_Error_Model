rqfit <- rq(Cover.Phrag ~ r_value, tau = c(.05, .25, .5, .75, .95),data = dat2)
summary(rqfit)
#built in function to show the change in quantile coefficients and the confidence intervals
#red lines is the least squares estimate and confidence intervals
#black dots are slope coefficient at the given quantile
jpeg("qreg_ci.jpeg", height = 400, width = 500)
plot(summary(rqfit), parm = "r_value",
xlab = "Quantile",
ylab = "Slope Coefficient")
dev.off()
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Growth Rate (Proportional Cover Per Day)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
library(quantreg)
library(tidyverse)
#load("r_values_table.RData")
values <- read.csv("r_values.csv")
load("main_dfs.RData")
#Let's clean up the r values sheet we need to use
dat <- values %>%
pivot_longer(4:7,
names_to = "Tub",
values_to = "r_value") %>%
separate(col = "Tub",
into = c("Density", "Phrag_Presence"),
sep = 1)
#First, we need to make a table that includes both of these values
dat2 <- greenhouse %>%
filter(Date_Cleaned == "2022-05-16",
Phrag_Presence == "W") %>%
select(Species, Density, Phrag_Presence, Block, Cover.Phrag) %>%
left_join(dat, by = c("Species", "Density", "Phrag_Presence"))
rqfit <- rq(Cover.Phrag ~ r_value, tau = c(.05, .25, .5, .75, .95),data = dat2)
summary(rqfit)
#Now graph them
#base r graph
color <- c("#ffcccc", "#ff9999", "#ff6666", "#ff3333", "#ff0000")
library(gridExtra)
jpeg("quantile_regression.jpeg", height = 400, width = 400)
plot(Cover.Phrag ~ r_value, data = dat2,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
plot(Cover.Phrag ~ r_value, data = dat2,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
#built in function to show the change in quantile coefficients and the confidence intervals
#red lines is the least squares estimate and confidence intervals
#black dots are slope coefficient at the given quantile
jpeg("qreg_ci.jpeg", height = 400, width = 500)
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Growth Rate (Proportional Cover Per Day)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Growth Rate (Proportional Cover Per Day)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
dat2
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Growth Rate (Proportional Cover Per Day)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
dev.off()
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Growth Rate (Proportional Cover Per Day)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
plot(summary(rqfit), parm = "r_value",
xlab = "Quantile",
ylab = "Slope Coefficient")
library(quantreg)
library(tidyverse)
#load("r_values_table.RData")
values <- read.csv("r_values.csv")
load("main_dfs.RData")
View(r_values)
values
glimpse(r_values)
glimpse(values)
#Let's clean up the r values sheet we need to use
dat <- values %>%
pivot_longer(c(HW, HWO, LW, LWO),
names_to = "Tub",
values_to = "r_value") %>%
separate(col = "Tub",
into = c("Density", "Phrag_Presence"),
sep = 1)
dat
#load("r_values_table.RData")
values <- read.csv("r_values.csv")
View(values)
dat <- values %>%
select(1:4, 7, 10, 13, 16, 17)
View(dat)
#Let's clean up the r values sheet we need to use
dat <- values %>%
select(1:4, 7, 10, 13, 16, 17) %>%
pivot_longer(4:7,
names_to = "Tub",
values_to = "r_value") %>%
separate(col = "Tub",
into = c("Density", "Phrag_Presence"),
sep = 1)
#First, we need to make a table that includes both of these values
dat2 <- greenhouse %>%
filter(Date_Cleaned == "2022-05-16",
Phrag_Presence == "W") %>%
select(Species, Density, Phrag_Presence, Block, Cover.Phrag) %>%
left_join(dat, by = c("Species", "Density", "Phrag_Presence"))
rqfit <- rq(Cover.Phrag ~ r_value, tau = c(.05, .25, .5, .75, .95),data = dat2)
summary(rqfit)
#Now graph them
#base r graph
color <- c("#ffcccc", "#ff9999", "#ff6666", "#ff3333", "#ff0000")
library(gridExtra)
plot(Cover.Phrag ~ r_value, data = dat2,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
plot(summary(rqfit), parm = "r_value",
xlab = "Quantile",
ylab = "Slope Coefficient")
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Growth Rate (Proportional Cover Per Day)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
ggsave("quant_reg_ggplot.jpeg")
par(mfrow = c(1, 2))
plot(Cover.Phrag ~ r_value, data = dat2,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
plot(summary(rqfit), parm = "r_value",
xlab = "Quantile",
ylab = "Slope Coefficient")
plot(summary(rqfit), parm = "r_value",
xlab = "Quantile",
ylab = "Slope Coefficient",
title = "")
plot(summary(rqfit), parm = "r_value",
xlab = "Quantile",
ylab = "Slope Coefficient")
plot(summary(rqfit), parm = "r_value",
xlab = "Quantile",
ylab = "Slope Coefficient")
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag, color = color))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = color),
size = 1.5) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1.5) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color)
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color)
#ggplot graph
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color) +
ylim(0, 0.5)
#ggplot graph
library(viridis)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_viridis() +
ylim(0, 0.5)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_viridis() +
ylim(0, 0.5)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_viridis(option = "magma") +
ylim(0, 0.5)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_viridis(option = "cividis") +
ylim(0, 0.5)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_viridis_c(option = "cividis") +
ylim(0, 0.5)
#ggplot graph
library(viridisLite)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_viridis_c(option = "cividis") +
ylim(0, 0.5)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown())
viridis(q_colors)
library(scales)
viridis(q_colors)
show_col(viridis_pal()(20))
q_colors =  15
v_colors =  viridis(q_colors, option = &amp;quot;D&amp;quot;)
v_colors =  viridis(q_colors, option = "D")
v_colors
#ggplot graph
color <- c("#440154FF","#3F4889FF", "#277F8EFF", "#4AC16DFF","#FDE725FF" )
scale_color_manual(values = color) +
ylim(0, 0.5)
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color) +
ylim(0, 0.5)
v_colors
#ggplot graph
color <- c("#440154FF","#277F8EFF", "#1FA187FF", "#4AC16DFF","#FDE725FF" )
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color) +
ylim(0, 0.5)
v_colors =  viridis(q_colors, option = "A")
v_colors
show_col(viridis_pal()(5))
viridis(5, option = "A")
#ggplot graph
color <- c("#000004FF", "#51127CFF", "#B63679FF", "#FB8861FF", "#FCFDBFFF" )
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color) +
ylim(0, 0.5)
viridis(5, option = "D")
#ggplot graph
color <- c("#440154FF", "#3B528BFF", "#21908CFF", "#5DC863FF", "#FDE725FF" )
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color) +
ylim(0, 0.5)
"#000004FF", "#51127CFF", "#B63679FF", "#FB8861FF", "#FCFDBFFF"
#ggplot graph
color <- c("#000004FF", "#51127CFF", "#B63679FF", "#FB8861FF", "#FCFDBFFF" )
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color) +
ylim(0, 0.5)
color <- c("#FCFDBFFF" , "#FB8861FF", "#B63679FF", "#51127CFF","#000004FF" )
dat2 %>%
ggplot(aes(x = r_value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95),
aes(color = factor(..quantile..)),
size = 1) +
xlab("Intrinsic Rate of Growth (r)") +
ylab("*Phragmites* Cover") +
labs(color = "Quantiles") +
theme(axis.title.y = ggtext::element_markdown()) +
scale_color_manual(values = color) +
ylim(0, 0.5)
ggsave("quant_reg_ggplot.jpeg")
library(tidyverse)
values <- read.csv("r_values.csv")
View(values)
glimpse(values)
graph_values <- values %>%
select(-c(Model, R2, n0, sd))
graph_r <- graph_values %>%
select('Species', 'HW', 'HWO', 'LW', 'LWO') %>%
pivot_longer(cols = c('HW', 'HWO', 'LW', 'LWO'),
names_to = "names",
values_to = "value")
graph_upr <- graph_values %>%
select('Species', 'HW_upr', 'HWO_upr', 'LW_upr', 'LWO_upr') %>%
pivot_longer(cols = c('HW_upr', 'HWO_upr', 'LW_upr', 'LWO_upr'),
names_to = "upr_names",
values_to = "upr_value")
graph_upr$names <- graph_r$names
graph_lwr <- graph_values %>%
select('Species', 'HW_lwr', 'HWO_lwr', 'LW_lwr', 'LWO_lwr') %>%
pivot_longer(cols = c('HW_lwr', 'HWO_lwr', 'LW_lwr', 'LWO_lwr'),
names_to = "lwr_names",
values_to = "lwr_value")
graph_lwr$names <- graph_r$names
graph1 <- left_join(graph_r, graph_upr, by = c("Species", "names"))
graph2 <- left_join(graph1, graph_lwr, by = c("Species", 'names'))
final <- graph2 %>%
select(-c(upr_names, lwr_names))
final %>%
ggplot(aes(x = names, y = value)) +
geom_point() +
facet_wrap(~Species, ncol = 6) +
geom_errorbar(aes(ymin = lwr_value, ymax = upr_value)) +
xlab("Treatment") +
ylab("Intrinsic rate of growth (r)") +
theme(axis.text.x = element_text(angle = 45, hjust = 0.9))
ggsave("r_values_graph.jpeg")
