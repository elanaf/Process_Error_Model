# alpha <- unlist(alpha)
# beta <- param[2]
# beta <- unlist(beta)
predN[predN==0]<-.01
predN[predN==1]<-.99
# print(obs)
# print(predN)
liks<-0
for(j in 1:nrow(obs)){
lastobs <- 0
for(i in 1:ncol(obs)){
if(!is.na(obs[j, i])){
tbtwn<-i-lastobs
# print(tbtwn)
liks<-c(liks, dnorm(x=qlogis(obs[j, i]),mean=qlogis(predN[j, i]),sd=sqrt(tbtwn*s^2)))
lastobs<-i
# print(liks)
}
}
}
# likes <- dbeta(x=obs2,shape1 = alpha, shape2 = beta)
# likes <- dnorm(x=qlogis(obs2), mean=plogis(predN2), sd = sd)
nll<--1*sum(log(liks[-1]))
return(nll)
}
nll.multi.func.p(lr = log(.4),
ln0 = log(.01), obs = native.mat, lsd = log(.05))
# Create list of starting guesses for the multi model
start.list<-list(lr=log(.1),
lsd = log(.05),
ln0 = log(0.001))
# Create list of observed data for model
data.list<-list(obs=native.mat, method = "SANN")
# Find MLE parameter estimates
fit_n<-mle2(minuslogl=nll.multi.func.p,start=start.list,data=data.list, method = "SANN")
# store MLE parameter estimates
cfs_n<-exp(coef(fit_n))
cfs_n
AICmp <- AIC(fit_mp)
AICnd <- AIC(fit_nd)
AICnp <- AIC(fit_np)
AICn <- AIC(fit_n)
# Calculate delta AIC for each model
dAICmp <- AICmp-min(AICmp, AICnd, AICnp, AICn)
dAICnd <- AICnd-min(AICmp, AICnd, AICnp, AICn)
dAICnp <- AICnp-min(AICmp, AICnd, AICnp, AICn)
dAICn <- AICn-min(AICmp, AICnd, AICnp, AICn)
# Calculate relative likelihood for each model
rAICmp <- exp(-.5*dAICmp)
rAICnd <- exp(-.5*dAICnd)
rAICnp <- exp(-.5*dAICnp)
rAICn <- exp(-.5*dAICn)
# Calculate AIC weights for each model
AICwmp <- rAICmp/sum(rAICmp,rAICnd, rAICnp, rAICn)
AICwn <- rAICn/sum(rAICmp,rAICnd, rAICnp, rAICn)
AICwnp <- rAICnp/sum(rAICmp,rAICnd, rAICnp, rAICn)
AICwnd <- rAICnd/sum(rAICmp,rAICnd, rAICnp, rAICn)
AICwmp
AICwn
AICwnp
AICwnd
?quantreg
library(quantreg)
load("r_values_table.RData")
library(quantreg)
load("r_values_table.RData")
View(data_read
)
data(mtcars)
force(mtcars)
load("main_dfs.RData")
View(greenhoues)
View(greenhouse)
?left_join
dat <- left_join(greenhouse, data_read, by = c(Species, Density, Phrag_Presence))
dat <- greenhouse %>%
left_join(data_read, by = c(Species, Density, Phrag_Presence))
dat <- greenhouse %>%
left_join(data_read, by = c("Species", "Density", "Phrag_Presence"))
View(dat)
glimpse(greenhouse)
dat <- greenhouse %>%
filter(Date == 2022-05-16) %>%
select(Species, Density, Phrag_Presence, Cover.Phrag) %>%
left_join(data_read, by = c("Species", "Density", "Phrag_Presence"))
View(dat)
dat <- greenhouse %>%
filter(Date == 2022-05-16) %>%
select(Species, Density, Phrag_Presence, Cover.Phrag)
dat <- greenhouse %>%
filter(Date == 2022-05-16)
dat <- greenhouse %>%
filter(Date == "2022-05-16") %>%
select(Species, Density, Phrag_Presence, Cover.Phrag)
dat <- greenhouse %>%
filter(Date == "2022-05-16",
Phrag_Presence == "WO") %>%
select(Species, Density, Phrag_Presence, Cover.Phrag) %>%
left_join(data_read, by = c("Species", "Density", "Phrag_Presence"))
dat <- greenhouse %>%
filter(Date == "2022-05-16",
Phrag_Presence == "W") %>%
select(Species, Density, Phrag_Presence, Cover.Phrag) %>%
left_join(data_read, by = c("Species", "Density", "Phrag_Presence"))
View(dat)
dat <- greenhouse %>%
filter(Date == "2022-05-16",
Phrag_Presence == "W") %>%
select(Species, Density, Phrag_Presence, Cover.Phrag)
dat <- greenhouse %>%
filter(Date == "2022-05-16",
Phrag_Presence == "W") %>%
select(Species, Density, Phrag_Presence, Block, Cover.Phrag)
greenhouse %>%
filter(Date == "2022-05-16",
Phrag_Presence == "W")
dat <- greenhouse %>%
filter(Date == "2022-05-16",
Phrag_Presence == "W")
dat <- greenhouse %>%
filter(Date_Cleaned == "2022-05-16",
Phrag_Presence == "W")
dat <- greenhouse %>%
filter(Date_Cleaned == "2022-05-16",
Phrag_Presence == "W") %>%
select(Species, Density, Phrag_Presence, Block, Cover.Phrag) %>%
left_join(data_read, by = c("Species", "Density", "Phrag_Presence"))
rqfit <- rq(Cover.Phrag ~ value, data = dat)
summary(rqfit)
dat <- greenhouse %>%
filter(Date_Cleaned == "2022-05-16",
Phrag_Presence == "W", Block == 1) %>%
select(Species, Density, Phrag_Presence, Block, Cover.Phrag) %>%
left_join(data_read, by = c("Species", "Density", "Phrag_Presence"))
rqfit <- rq(Cover.Phrag ~ value, data = dat)
summary(rqfit)
dat <- greenhouse %>%
filter(Date_Cleaned == "2022-05-16",
Phrag_Presence == "W") %>%
select(Species, Density, Phrag_Presence, Block, Cover.Phrag) %>%
left_join(data_read, by = c("Species", "Density", "Phrag_Presence"))
rqfit <- rq(Cover.Phrag ~ value, data = dat)
summary(rqfit)
faq()
faq(rqfit)
faq(summary(rqfit))
summary(rqfit)
rqfit <- rq(Cover.Phrag ~ value, tau = c(.05, .25, .5, .75, .95),data = dat)
summary(rqfit)
mtcars
rqfit
#Now graph them
plot(Cover.Phrag ~ value, data = dat)
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italics("Phragmites ")"cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italics("Phragmites "), "cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italic("Phragmites "), "cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italic("Phragmites ") "cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italic("Phragmites ") + "cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italic("Phragmites ")  "cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italic("Phragmites "),  "cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = expression(italic("Phragmites ")  "cover"))
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = substitute(paste(italic("Phragmites "), "cover"))
)
#Now graph them
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
rqfit[,1]
rqfit
rqfit[1,]
rqfit[1]
rqfit[2]
coef(rqfit)[, 1]
coef(rqfit)[, 2]
coef(rqfit)[, 3]
coef(rqfit)[, 4]
coef(rqfit)[, 5]
coef(rqfit)[, 6]
#Now graph them
color <- c("#ffe6e6", "#ffcccc", "#ff9999", "#ff6666", "#ff3333")
rqfit$coefficients
abline(coef(rqfit)[, j], col = colors[j])
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = colors[j])
}
ncol(rqfit$coefficients)
j <- 1
coef(rqfit)[, j]
abline(coef(rqfit)[, 1], col = colors[1]
)
#Now graph them
color <- c("#ffe6e6", "#ffcccc", "#ff9999", "#ff6666", "#ff3333")
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = colors[j])
}
abline(coef(rqfit)[, j], col = color[j])
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
?legend
legend(legend = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
legend(x = 4, legend = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
legend(x = 1, legend = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
legend(x = right, legend = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
legend(x = "right", legend = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
color <- c("#ffe6e6", "#ffcccc", "#ff9999", "#ff6666", "#ff3333")
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95), col = color)
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1)
#Now graph them
color <- c("#ffcccc", "#ff9999", "#ff6666", "#ff3333", "#ff0000")
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)", ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover")),
main = "Quantile regression"
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1)
summary(rqfit)
rqfit
summary(rqfit)
polygon(x=c(seq(1,5),rev(seq(1,5))),y=c(lwrN,rev(uprN)),
col=adjustcolor("dodgerblue",.25),
border=adjustcolor("dodgerblue",.25))
polygon(x=c(seq(1,5),rev(seq(1,5))),y=c(1,rev(5)),
col=adjustcolor("dodgerblue",.25),
border=adjustcolor("dodgerblue",.25))
polygon(x=c(seq(1,5),rev(seq(1,5))),y=c(1,rev(1)),
col=adjustcolor("dodgerblue",.25),
border=adjustcolor("dodgerblue",.25))
polygon(x=c(seq(1,5),rev(seq(1,5))),y=c(-1,rev(1)),
col=adjustcolor("dodgerblue",.25),
border=adjustcolor("dodgerblue",.25))
#Now graph them
dat %>%
mutate(quant =
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
})
#Now graph them
dat <- dat %>%
mutate(quant =
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
})
#Now graph them
dat <- dat %>%
mutate(quant =
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
})
#Now graph them
reg_coef <- c()
for (j in 1:ncol(rqfit$coefficients)) {
reg_coef[j] <- coef(rqfit)[, j]
})
for (j in 1:ncol(rqfit$coefficients)) {
reg_coef[j] <- coef(rqfit)[, j]
}
reg_coef
coef(rqfit)[,1]
coef(rqfit)[,2]
coef(rqfit)[,3]
coef(rqfit)[,4]
coef(rqfit)[,5]
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point()
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile()
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
#ggplot graph with confidence intervals
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(color = color, quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
#ggplot graph with confidence intervals
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(color = color, quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
color
#ggplot graph with confidence intervals
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(color = red, quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
#ggplot graph with confidence intervals
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(color = color, quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
#ggplot graph with confidence intervals
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(colour = color, quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
#Now graph them
#base r graph
color_list <- c("#ffcccc", "#ff9999", "#ff6666", "#ff3333", "#ff0000")
#ggplot graph with confidence intervals
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(colour = color_list, quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
#ggplot graph with confidence intervals
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
?geom_smooth
plot(summary(rqfit))
plot(summary(rqfit), parm = x)
plot(summary(rqfit), parm = "x")
plot(summary(rqfit), parm = "y")
#ggplot graph
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
#Now graph them
#base r graph
color <- c("#ffcccc", "#ff9999", "#ff6666", "#ff3333", "#ff0000")
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover")),
main = "Quantile regression"
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1)
summary(rqfit)
rqfit
summary(rqfit, se = "ker")
?rq
summary(rqfit)
summary(rqfit, method = "rank")
summary(rqfit, method = "rank")
summary(rqfit, method = "nid")
summary(rqfit, method = "oiid")
summary(rqfit, method = "iid")
summary(rqfit, se = "rank")
summary(rqfit, se = "iid")
summary(rqfit, se = "nid")
summary(rqfit, se = "ker")
rqfit <- rq(Cover.Phrag ~ value, tau = c(.05, .25, .5, .75, .95),data = dat)
summary(rqfit, se = "ker") #need to check about which method of se is best
summary(rqfit) #need to check about which method of se is best
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1)
color <- c("#ffcccc", "#ff9999", "#ff6666", "#ff3333", "#ff0000")
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover")),
main = "Quantile regression"
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1)
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
#Now graph them
#base r graph
color <- c("#ffcccc", "#ff9999", "#ff6666", "#ff3333", "#ff0000")
library(gridExtra)
jpeg("r_value_data.jpeg", height = 1500, width = 400)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
library(gridExtra)
jpeg("r_value_data.jpeg", height = 1500, width = 400)
grid.table(data_read)
dev.off()
save(data_read, file = "r_values_table.RData")
jpeg("quantile_regression.jpeg", height = 1500, width = 400)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
jpeg("quantile_regression.jpeg", height = 400, width = 400)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
#ggplot graph
dat %>%
ggplot(aes(x = value, y = Cover.Phrag))+
geom_point() +
geom_quantile(quantiles = c(0.05, 0.25, 0.5, 0.75, 0.95))
jpeg("quantile_regression.jpeg", height = 4000, width = 4000)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
jpeg("quantile_regression.jpeg", height = 1000, width = 1000)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
jpeg("quantile_regression.jpeg", height = 800, width = 800)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
jpeg("quantile_regression.jpeg", height = 500, width = 500)
plot(Cover.Phrag ~ value, data = dat,
xlab = "Growth rate (r)",
ylab = substitute(paste("Proportional ", italic("Phragmites "), "cover"))
)
for (j in 1:ncol(rqfit$coefficients)) {
abline(coef(rqfit)[, j], col = color[j])
}
legend(x = "topright", legend = c(0.05, 0.25, 0.5, 0.75, 0.95),
col = color, lty = 1, title = "Quantiles")
dev.off()
